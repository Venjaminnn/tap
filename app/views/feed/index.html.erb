<%= stylesheet_link_tag "index", media: "all" %>
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8"/>
    <link rel="stylesheets" href="index.css"/>
     <style>
      .account {
        width: 75px;
        height: 75px;
        min-width: 40px;
        border-radius: 40%;
        border: 2px solid white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0px 5px rgba(0, 0, 0, 0.15);
      }
      .account:hover{
        background: #2e2f30;
      }
      .new-post {
        width: 75px;
        height: 75px;
        min-width: 40px;
        border-radius: 40%;
        border: 2px solid white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0px 5px rgba(0, 0, 0, 0.15);
      }
      .new-post:hover{
        background: #2e2f30;
      }
      .notifications {
        width: 75px;
        height: 75px;
        min-width: 40px;
        border-radius: 40%;
        border: 2px solid white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0px 5px rgba(0, 0, 0, 0.15);
      }
      .notifications:hover{
        background: #2e2f30;
      }
      .logout {
        width: 75px;
        height: 75px;
        min-width: 40px;
        border-radius: 40%;
        border: 2px solid white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0px 5px rgba(0, 0, 0, 0.15);
      }
      .logout:hover{
        background: #2e2f30;
      }

      .questions {
        width: 75px;
        height: 75px;
        min-width: 40px;
        border-radius: 40%;
        border: 2px solid white;
        display: flex;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        box-shadow: 0px 5px rgba(0, 0, 0, 0.15);
      }
      .questions:hover{
        background: #2e2f30;
      }

      /* Общие стили */
      .index {
        min-width: 100vw;
        min-height: 100vh;
        width: 100vm;
        height: 100vh;
        background-color: #626262;
        background-image: none !important;
        display: flex;
        overflow-x: hidden;
        padding: 0px 40px;
        /* margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Sarala', sans-serif;
        background-color: rgba(98, 98, 98, 1);
        background-image: none !important; */
      }
      .menu {
        position: fixed;
        top: 0;
        left: 0;
        width: px;
        height: 100%;
        padding: 20px;
        /* flex: 1;
        position: fixed;
        width: 100%;
        height: 90px;
        left: 0px;
        top: 0px;
        background-color: #626262;
        filter: drop-shadow(-4px 4px 4px rgba(0, 0, 0, 0.25)); */
      }

      .menuContainer {
        border-radius: 40%;
        justify-content: center;
        align-items: center;
        cursor: pointer;
        margin: 50px 0;
      }
      main {
        flex: 1;
        height: 100%;
        padding-top: 35px;
        margin-left: 130px;
      }
      /* p {
        color: white;
        width: 66px;
        height: 35px;
        left: 88px;
        top: 129px;
        font-size: 35px;
      } */
      .searchBox {
        margin-left: 10px;
        display: absolute;
        align-items: center;
        justify-content: center;
        width: 100%;
        background: #2F2F2F;
        padding: 8px 15px;
        box-shadow: 0px 0px 13px 2px rgba(11, 11, 11, 0.25);
        border: 1px solid #525252;
        border-radius: 25px;
      }
      .search input {
        /* position: absolute;
        width: 593px;
        height: 50px;
        left: 600px;
        top: 24px;
        background-color: #2F2F2F;
        border: 1px solid #303030;
        border-radius: 25px;
        box-shadow: 0px 0px 13px 2px rgba(11, 11, 11, 0.25);
        transition: 0.5s;
        align-items: right;
        text-align: left;
        outline: none; */
        width: 595px; 
        height: 50px;
        outline: none;
        border: none;
        color: white;
        font-weight: bold;
        border-radius: 25px;
        background: #2F2F2F;
      }
      input[name] {
        font-family: 'Sarala';
        font-style: normal;
        font-weight: 400;
        font-size: 18px;
        line-height: 29px;
        letter-spacing: 0.105em;
        color: #FFFFFF;
        padding: 15px;
      }
      /* .post-image input[type="image" i] {
        box-sizing: border-box;
        position: relative;
        width: 50px;
        height: 40px;
        left: 595px;
        top: 3px;
        background: #2F2F2F;
        border-radius: 25px;
      } */
      /* td.new-post {
        background: linear-gradient(90deg, #F093FB 0%, #F093FB 0.01%, #F5576C 100%, #F5576C 100%);
        position: absolute;
        width: 142px;
        height: 59px;
        left: 80%;
        top: 20px;
        border-radius: 23px;
        font-style: normal;
        text-align: center;
        font-size: 20px;
        font-weight: 400;
      }

      td.new-post img {
        position: left;
        width: 32px0;
        height: 33px;
        margin-top: 10px;
        transform: translate(-10%, 10%);
      }

      td.new-post a:hover {
        background: linear-gradient(90deg, #B848C6 0%, #F5576C 100%);
        position: absolute;
        width: 142px;
        height: 59px;
        left: 80%;
        top: 20px;
        border-radius: 23px;
        font-style: normal;
        text-align: center;
        font-size: 20px;
        font-weight: 400;
      }
      td.new-post a {
        color: white;
      } */

      /* .post-list {
        list-style: none;
        padding: 0;
        margin: 120px 20px;
        column-count: 1;
      } */

      /* .post {
        margin-bottom: 30px;
        padding: 10px;
        background-color: rgba(50, 50, 50, 0.5);
        border-radius: 10px;
        border: 1px solid #3E3E3E;
        box-shadow: 0px s4px 4px rgba(0, 0, 0, 0.25);
        margin: 0 2px 15px;
        padding: 15px;
        padding-bottom: 10px;
        transition: opacity .4s ease-in-out;
        display: inline-block;
        column-break-inside: avoid;
        column-gap: 15px;
        max-width: 1100px;
        margin: 50px 90px;
      } */

      /* .post img {
        border-radius: 10px;
        padding-bottom: 15px;
        margin-bottom: 5px;
        transition: 0.4s;
      } */

      /* .post img:hover{ 
        transform: scale(1.1);
      } */

      /* .post-content {
        flex: 1;
      } */

      /* .post-actions {
        display: flex;
        align-items: center;
        margin-left: auto;
      } */

      /* .post-actions img {
        margin-right: 10px;
      } */

      /* .post-comment {
        margin: 0;
        font-size: 18px;
        line-height: 1.2;
        top: 850px;
        left: 65%;
      } */


      /* Стили для сообщения об успехе (notice)
      #notice {
        background-color: #dff0d8;
        border: 1px solid #d6e9c6;
        border-radius: 3px;
        color: #3c763d;
        font-size: 16px;
        margin: 0;
        padding: 10px;
        text-align: center;
      } */

      #list {
        width: 100%;
        overflow: hidden;
        margin-bottom: -1.875em;
        -webkit-column-count: 3;
        -webkit-column-gap: 1.875em;
        -webkit-column-fill: auto;
        -moz-column-count: 3;
        -moz-column-gap: 1.875em;
        -moz-column-fill: auto;
        column-count: 3;
        column-gap: 1.875em;
        column-fill: auto;
      }

      .post-list {
        margin-left: 100px;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(550px, 1fr));
        margin-top: 30px;
      }

      .post {
        border: 1px solid #3E3E3E;
        border-radius: 5px;
        overflow: hidden;
        box-shadow:0px 4px 4px rgba(0, 0, 0, 0.25);
        float: left;
        transition: transform 0.2s ease-out;
        margin: 0 10px 10px 0;
      }

      .post:hover {
        transform: translateY(-10px);
      }

      .post-image {
        position: relative;
        cursor: -webkit-zoom-in;
        cursor: -moz-zoom-in;
      }

      .post-image:before {
        content: "";
        display: block;
        padding-bottom: 100%;
      }

      .post-image img {
        max-width: 100%;
        height: 100%;
        object-fit: cover;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }

      .post-comment {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: none;
        color: white;
        font-size: 28px;
        padding: 10px;
      }

      .post-actions {
        background-color: transparent;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px;
        font-size: 0.8em;  
        transform: translateY(75px);
        transition: transform 0.2s ease-out;
      }

      .post:hover .post-actions {
        display: flex;
        transform: translateY(0);
      }

      .post-image:target::before {
        content: "";
        position: fixed;
        top: 0;
        left: 0;
        bottom: 0;
        right: 0;
        background: rgba(0, 0, 0, 0.5);
        z-index: 999;
        display: flex;
        justify-content: center;
        align-items: center;
      }
      .body {
        background: #626262;
      }
      #notice {
        display: none; 
        position: fixed;
        top: 0;
        left: 50%;
        transform: translateX(-50%);
        z-index: 9999;
        width: 300px;
        padding: 10px;
        background-color: #fff;
        box-shadow: 0px 5px 10px rgba(0,0,0,0.3);
        border: 1px solid #ccc;
      }

      #notice.show {
        display: block; 
        animation: fade 1s ease-out forwards;
      }

      @keyframes fade {
        from {
          opacity: 0;
          transform: translate(-50%, -10%);
        }
        to {
          opacity: 1;
          transform: translate(-50%, 0);
        }
      }
      .likes-count {
        color: #ffffff;
        margin-left: 5px;
        font-size: 14px;
        font-weight: bold;

      }
      .likes {
        display: flex;
        align-items: center;
      }
    </style>
    <script>
      const notice = document.querySelector('#notice');

      notice.classList.add('show');
      setTimeout(() => {
        notice.classList.remove('show');
      }, 5000);
    </script>
  </head>
  
  <body>
    <div class="index">

      <div class="menu">

        <div>
          <td class="logo"><%= image_tag('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982420/logo_vy7isg.svg', width:'145px', height:'145px')%></td>
        </div>
        
        <div style="margin: 30px">

          <p id="notice"><%= flash[:notice] %></p>

            <tr>
            
              <div class="menuContainer">
                <div class="account" style="margin: 15px 0"><td><%= link_to (image_tag('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982421/person_pl8ytb.svg')), user_path(@current_user) %></td></div>
                <div class="notifications" style="margin: 15px 0"><td><%= link_to (image_tag ('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982420/notifications_lg4g2z.svg')) %></td></div>
                <div class="new-post" style="margin: 15px 0"><td><%= link_to (image_tag ('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982418/add_btzygi.svg')), new_post_path, method: :get %></td></div>
              </div>

              <div class="questions" style="margin: 15px 0"><td><%= link_to (image_tag('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982422/questions_exwzsj.svg')) %></td></div>

              <div class="logout">
                <td><%= link_to (image_tag asset_path('https://res.cloudinary.com/hzodm3yak/image/upload/v1678982420/logout_pjb0fx.svg')), logout_path, data: {turbo_method: :delete}, method: :delete %></td>
              </div>

            </tr>
        </div>
    </div>

    <main>
      <div class="searchBox">
        <div class="search" >
        
          <td>
            <%= form_tag users_path, method: :get do %>
              <td>
                <%= text_field_tag :search, params[:search], placeholder: "  Search..." %>
              </td>
            <% end %>
          </td>
        </div>
      </div>

       <div class="feed"> 
        <ul class="post-list">
          <% @feed_posts.each do |feed_post| %>
            <li id="list" class="post">
              <div class="post-image">
                <%= link_to cl_image_tag(feed_post.image.url, style: 'margin-bottom: 7px, height: 7em') %>
                 <p class="post-comment"><%= feed_post.comment %></p>
              </div>
            
            
              <div class="post-actions">
                <%= link_to post_edit_path(feed_post) do %>
                   <%= image_tag 'https://res.cloudinary.com/dx1gxrz2q/image/upload/v1679150397/edit_u4hglm.svg', width: '44px', height: '42px'%> 
                 <% end %> 
              
              <div class="likes">
                <span class="likes-count"><%= "#{feed_post.likes_count} #{'like'.pluralize(feed_post.likes_count)}" %></span>

                <% if feed_post.liked_by?(@current_user) %>
                  <%= link_to destroy_post_likes_path(feed_post.id), data: {turbo_method: :delete }, class: "like-button" do %>
                    <%= image_tag 'https://res.cloudinary.com/hzodm3yak/image/upload/v1678982420/like_qfc6jk.svg', width: '44px', height: '42px' %>
                  <% end %>
                <% else %>
                  <%= link_to post_likes_path(feed_post.id), data: {turbo_method: :post }, class: "like-button active" do %>
                    <%= image_tag 'https://res.cloudinary.com/hzodm3yak/image/upload/v1678982422/unlike_wkmers.svg', width: '44px', height: '42px' %>
                  <% end %>
                <% end %>
              </div>
                 <%= link_to (image_tag 'https://res.cloudinary.com/hzodm3yak/image/upload/v1678982418/comment_icon_xim1ky.svg', width: '44px', height: '42px'), post_comments_path(feed_post.id), method: :get %> 
              </div> 
            </li>
          <% end %>
        </ul>
      </div>
    </main>
    </div>
  </body>
</html>